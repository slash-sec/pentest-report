\section{Schwachstelle 8: Wiederverwendung von Passwörtern und Zugängen bei BigCindy (SSH)}
\label{sec:vuln8}


\subsection{Beschreibung der Schwachstelle}
\label{subsec:vuln8_way}
Die Analyse des Nmap-Scans aus dem vorherigen Kapitel hat ergeben, dass beim Host \texttt{BigCindy} lediglich auf Port 22 ein SSH-Server in der Version 7.7 verfügbar ist. Weitere manuelle Analysen hatten ergeben, dass die gleichen Zugangsdaten, welche für den den Host \texttt{myron} (IP: 172.16.30.80 bzw. 172.16.33.10) funktioniert hatten auch für BigCindy gültig sind. Abbildung \ref{fig:bigcindy_ssh_login} zeigt, wie mittels \texttt{ssh myron@BigCindy.int.mb-reps.cool.datcom.prv} und dem Passwort \texttt{L1v1n9570n} Zugang zum Host \texttt{BigCindy} erlangt wurde. Es handelt sich dabei um einen eingeschränkten Account ohne Root-Berechtigungen.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{./img/vuln8_bigcindy/ssh_login}
    \caption{Erfolgreicher SSH-Login bei \texttt{BigCindy} mit bekannten Zugangsdaten von \texttt{myron}}
    \label{fig:bigcindy_ssh_login}
\end{figure}


Des Weiteren konnte unter \texttt{/home/myron/.ssh} ein privater und öffentlicher Schlüssel für SSH-Verbindungen mittels Public-Key-Authentifizierungsverfahren aufgedeckt werden. Textauszug \ref{lst:vuln8_sshkeys} zeigt die Ausgabe der beiden Dateien.

\lstset{language=bash,caption={Ausgabe des privaten und öffentlichen SSH-Keys von \texttt{myron} auf dem Host \texttt{BigCindy}}, label=lst:vuln8_sshkeys}
\begin{lstlisting}[frame=single, firstnumber=1, stepnumber=1,]
myron@bigcindy:~/.ssh$ cat id_rsa
cat id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAuPSGZ3RoM20MXsdg2VAyysiIURT2gqajrIJOuk/9R3t/ttPL
1n289jv3yJLYqeXQuh7MyjbBxer9tbjuB1gicrMrvxWr7tS7pdBcSW7YQb6+g5Qr
0gs78Yj041ZhOrhesxzLuvPhElwXDDPt0xpmdWeVAT3IICeXs7xmqAv78WPe5e98
rYpY8bqGFiv337TxdKxIjS32C/C1dYo0Aaw94cciF9RLOGaAbxPhMAHtmrbTXOqY
uE8MH6/aGzGpsU59dXJ7CUjqRJpOuTqAqt3+dKkQUKqZWlKo08dSMso4qRZTdwwJ
H66cosW9x9okqpywQhRZ8SWrBQTc0FBTsDwZwwIDAQABAoIBAGeHGCSYmCsRAzea
Sq/ZoFS54vPf1AxV0pAhcIgBdjio/FgOPa8WOstpzczLxdNz/F3yF5epBtYOL22k
0jfyMXYarIYNT2wkT9UEyGOiVBKY/nMQYWb1Otx8WPdXxpzjzr5bg/5lvLpWKeB+
wMTFpkxZaqKDPp4hC11kO+Icsy3uUIbV9hB9dMpCDHylAjo4n4xdn5ewxtJLRnQ6
qMiMDfZB8aQVPvX8FL8x/DgBs5l788tXwzzREx5XSSqRT3P4+Evosun+FZonjqbd
DMvhMrJMWvDNE7H3ccbjPq9kY7gwkBsNbP2ETD2DP6SsCj6tCt1GKQTaMn+VX4tw
Wgpq42ECgYEA70bfZmvxbkmIulYlaHbNQnfXZa2Q9DfpLN8oZL7rdHI+oZazX9Ba
yxXZ9ddXu2Dr5gtxI4LpErSrmekHxGSIIGHN4ZctcIqfcORkHD1BKQa7soQs6lCc
Qd1HOo40egYWDmcGuQ2H63sAoKy4f+6PniSM+2UBlS9kQtwu4oxbTp8CgYEAxeG7
cfb8gU+v5H24ISeQ8TFit8r7c2rHWpanR9roJ/bqycPEa0IeAD8/QUem2Wip3ip0
ItunA7jvmQiVElgiCBJ91b/QKohXM18DpLUyxSi0+Kh0KV01oufzMvPPwZ6WsllP
+43w6tAt3f4oqFEIkNtkp/flD1FtW3LHC7ylNl0CgYEAxF3NiSidAn2mkAWSvaCB
40KmqvM+Oq6H1iNt6wAkC3SWodYjb0Z2vKQ6M99+SHDKKAjL2PDehlNvYOg1T5+R
d8HMTI7c47dgEi3dWq+KgjjcYSzID6QIGKWYhx2dQ2crQraaddP87+wKH9Kft534
jzg/2zCRk/VIuvYoJBQ7+tECgYAPOtRmbQ/6E9wBxftJ8fWh2p8ybhj0RR+axUWS
rjJ4APUJGlwftTMB6dxAdfdNfFS2mKXfmPA9xRoLuTFf/BCCdongzaaD34J2nbV2
E8wYiI2FJdHq7RWXuCprnYA78qy+hUk2nzIPoH4nO8x9R99U5s3Ub6vdhfLYuvi+
2oIMsQKBgQDThCTXvJrDw6KxsXPzbZXRMGfxMj6e+WQdQns9k976x5WZXsUI4H8y
d4MU4M5te61XrAdPgtYQjvfuR+5TXbOXDjojL5svF8SCniQICY6hop339OYAWMIy
jGLude2r+v2IjnuYsweKeiDA6eza8rZUeTSlCp5k1xr902LYDoN2eQ==
-----END RSA PRIVATE KEY-----

myron@bigcindy:~/.ssh$ cat id_rsa.pub
cat id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC49IZndGgzbQxex2DZUDLKyIhRFPaCpqOsgk66T/1He3+208vWfbz2O/fIktip5dC6HszKNsHF6v21uO4HWCJysyu/Favu1Lul0FxJbthBvr6DlCvSCzvxiPTjVmE6uF6zHMu68+ESXBcMM+3TGmZ1Z5UBPcggJ5ezvGaoC/vxY97l73ytiljxuoYWK/fftPF0rEiNLfYL8LV1ijQBrD3hxyIX1Es4ZoBvE+EwAe2attNc6pi4Twwfr9obMamxTn11cnsJSOpEmk65OoCq3f50qRBQqplaUqjTx1IyyjipFlN3DAkfrpyixb3H2iSqnLBCFFnxJasFBNzQUFOwPBnD myron@bigcindy

\end{lstlisting} 

Weitere Analysen haben ergeben, dass der öffentliche Schlüssel bei dem Host \texttt{myron} mit der IP-Adresse \texttt{172.16.33.10} in der SSH-Konfiguration des Benutzers \texttt{myron} hinterlegt ist. Abbildung \ref{fig:myron_ssh_pub_key} zeigt den Inhalt der Datei \texttt{/home/myron/.ssh/authorized\_keys}. Somit ist es dem Benutzer \texttt{myron} auf dem Host \texttt{BigCindy} möglich, sich mit dem Befehl \texttt{ssh myron@172.16.33.10} ohne Angabe eines Passwortes sich über SSH anzumelden.


\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{./img/vuln8_bigcindy/ssh_key_myron}
    \caption{Öffentlicher SSH-Schlüssel von \texttt{myron} ist beim Host \texttt{myron} hinterlegt.}
    \label{fig:myron_ssh_pub_key}
\end{figure}

\subsection{Risikobewertung}
Da es sich bei dem Host, welcher neben dem SSH-Server keine weiteren unternehmenskritischen Dienste betreibt, um ein unkritisches System handelt, ist die Schadenshöhe für den Host \texttt{BigCindy} selbst gering. Allerdings kann mit den genannten SSH-Schlüsselpaar sich der Benutzer \texttt{myron} ohne Angabe eines Passworts auf den \texttt{myron}-Host in der DMZ anmelden. Insofern wird die Schadenshöhe im Falle einer Kompromittierung mit MITTEL bewertet. Die Eintrittswahrscheinlichkeit eines Schadens ist insbesondere abhängig von der Kenntnis des Passworts vom Benutzer \texttt{myron}, darüber hinaus muss sich der Angreifer im internen Netzwerk befinden oder aber als externer Angreifer mindestens die Schwachstelle 1 (webbasierte Ping-Tool) sowie Schwachstelle 7 (vulnerabler ProFTPD-Server) ausgenutzt haben, um Zugriff auf den Host \texttt{BigCindy} zu erhalten. Aufgrund der Verkettung, sowie aufgrund der nötigen Kenntnis des \texttt{myron}-Passworts, wird die Eintrittswahrscheinlichkeit ebenfalls mit MITTEL bewertet.

Das Gesamtrisiko wurde daher mit \textcolor{orange}{MITTEL} bewertet.

\subsection{Empfohlene Gegenmaßnahmen}
Neben der Einführung einer Passwort-Policy wird empfohlen die Verwendung eines Passworts nur für ein Konto zu gestatten. Darüber hinaus sollten private SSH-Keys immer verschlüsselt abgespeichert werden.

\subsection{Hinterlassene Spuren und Spurenbeseitigung}
Es wurden keine Dateien geändert, hinzugefügt oder Prozesse gestartet.

